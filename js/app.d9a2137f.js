(function(){"use strict";var e={8785:function(e,t,i){var o=i(9242),r=i(3396),a=i(7139);const n={class:"app-main"};function s(e,t,i,o,s,d){const c=(0,r.up)("IndexVue"),u=(0,r.up)("el-image");return(0,r.wg)(),(0,r.iD)("div",n,[(0,r.Wm)(c),((0,r.wg)(!0),(0,r.iD)(r.HY,null,(0,r.Ko)(s.desktopCapturerSourceList,((e,t)=>((0,r.wg)(),(0,r.iD)("div",{key:t},[(0,r.Wm)(u,{src:e.image},null,8,["src"]),(0,r.Uk)(" "+(0,a.zw)(e),1)])))),128))])}var d=i(6214),c=i(2827),u=i.n(c),p=i(6666),l=i(6e3),m=i(7178),v=i(4775);const h=e=>((0,r.dD)("data-v-5d44f6be"),e=e(),(0,r.Cn)(),e),w={class:"index-box"},g={key:1,class:"button-box"},f=h((()=>(0,r._)("div",{class:"title"},"录屏预览",-1))),b={ref:"displayMediaPreview",autoplay:"",class:"video-box"},y={class:"version"};function k(e,t,i,o,n,s){const d=(0,r.up)("el-button"),c=(0,r.up)("VideoCamera"),u=(0,r.up)("el-icon");return(0,r.wg)(),(0,r.iD)("div",w,[(0,r._)("div",null," 音频录制："+(0,a.zw)(o.audioIsSupported&&o.microphones.length>0?"支持":"不支持")+"; 屏幕录制："+(0,a.zw)(o.isSupported?"支持":"不支持"),1),o.enabled?(0,r.kq)("",!0):((0,r.wg)(),(0,r.j4)(d,{key:0,style:{"margin-top":"8px"},type:"primary",disabled:!o.isSupported,onClick:s.startUseDisplayMedia},{default:(0,r.w5)((()=>[(0,r.Uk)("开始录制")])),_:1},8,["disabled","onClick"])),o.enabled?((0,r.wg)(),(0,r.iD)("div",g,[(0,r.Wm)(u,{class:"icon-box",size:"20px"},{default:(0,r.w5)((()=>[(0,r.Wm)(c)])),_:1}),(0,r.Wm)(d,{type:"warning",onClick:s.stopUseDisplayMedia},{default:(0,r.w5)((()=>[(0,r.Uk)("⚪ 录屏中，点击停止录制")])),_:1},8,["onClick"])])):(0,r.kq)("",!0),f,(0,r._)("video",b,null,512),(0,r._)("div",y,"视频编码:"+(0,a.zw)(n.mimeType)+". 版本1.0.1",1)])}i(560),i(8858),i(1318),i(3228);var S=i(2748),M=i(6367),T=i(4419),D=i(6154),_=i(2373),x=i.n(_),C={name:"IndexBox",setup(){const{videoInputs:e,audioInputs:t,audioOutputs:i}=(0,M.j6b)({requestPermissions:!0}),o=(0,r.Fl)((()=>t.value[0]?.deviceId)),a=(0,r.Fl)((()=>e.value[0]?.deviceId));console.log(t,o,a);const{stream:n,start:s,stop:d,isSupported:c}=(0,M.Ox9)({constraints:{audio:{deviceId:o}}}),{stream:u,start:p,stop:l,enabled:m,isSupported:v}=(0,M.gmi)();return{stream:u,start:p,stop:l,enabled:m,audioStart:s,audioStop:d,audioStream:n,microphones:t,currentMicrophone:o,audioIsSupported:c,isSupported:v}},components:{VideoCamera:S.z1e},watch:{stream:{},audioStream:{handler(e){}}},data(){return{mediaRecorder:void 0,dataChunks:[],startRecordingTime:0,endRecordingTime:0,mimeType:"video/webm;codecs=vp9"}},created(){document.title="录屏工具";var e=["video/webm","video/x-matroska;codecs=avc1","audio/webm","video/mp4;codecs=avc1","video/invalid","video/mp4","video/webm;codecs=h264","video/webm;codecs=h265","video/mpeg","video/webm;codecs=vp8","video/webm; codecs=vp9"];e.forEach((e=>{MediaRecorder.isTypeSupported(e)&&(this.mimeType=e),console.log(e+" is "+(MediaRecorder.isTypeSupported(e)?"supported":"NOT supported "))}))},beforeUnmount(){this.stop(),this.audioStop()},methods:{async startUseDisplayMedia(){this.audioIsSupported&&this.microphones.length>0&&await this.audioStart(),await this.start(),(0,r.m0)((()=>{this.stream&&(this.$refs.displayMediaPreview.srcObject=this.stream)})),this.$nextTick((()=>{this.startRecording(this.stream,this.audioStream)}))},stopUseDisplayMedia(){this.stop(),this.audioStop(),this.stopRecording()},startRecording(e,t){let i;i=this.currentMicrophone?new MediaStream([...e.getTracks(),...t.getAudioTracks()]):e,this.mediaRecorder=new MediaRecorder(i,{mimeType:this.mimeType}),this.mediaRecorder.ondataavailable=e=>{let t=e.data;this.dataChunks.push(t)},this.startRecordingTime=(new Date).getTime(),this.mediaRecorder.start(1e3)},async stopRecording(){this.mediaRecorder.stop(),this.endRecordingTime=(new Date).getTime();const e=await x()(new Blob([...this.dataChunks],{type:this.mimeType}));this.dataChunks=[];let t=URL.createObjectURL(e);window.open(t),console.log(t);let i=(0,T.WJ)((0,M.mXi)(),"YYYY-MM-DD HH:mm:ss");(0,D.saveAs)(t,i.value+"录屏.webm")}}},I=i(89);const R=(0,I.Z)(C,[["render",k],["__scopeId","data-v-5d44f6be"]]);var O=R,A={name:"AppMain",components:{IndexVue:O},data(){return{userAgent:{},_ElNotification:p.bM,_ElMessageBox:l.T,_ElMessage:m.z8,_ElLoading:v.kN,_AntMessage:d.ZP,socket:void 0,desktopCapturerSourceList:[]}},computed:{},created(){window.app=this,window.electronAPI&&window.electronAPI.desktopCapturerGetSources&&(window.navigator.mediaDevices.getDisplayMedia=()=>(console.log("覆盖方法"),new Promise((async(e,t)=>{try{const t=await window.electronAPI.desktopCapturerGetSources();console.log(t);const i=await window.navigator.mediaDevices.getUserMedia({audio:!1,video:{mandatory:{chromeMediaSource:"desktop",chromeMediaSourceId:t[0].id}}});e(i)}catch(i){t(i)}}))))},mounted(){let e=new(u());e.setUA(navigator.userAgent);let t=e.getResult();this.userAgent=t,this.init()},methods:{async init(){this.desktopCapturerSourceList=await window.electronAPI.desktopCapturerGetSources(),console.log(await window.electronAPI.desktopCapturerGetSources())},async getDictData(e){if(e){const{data:t}=await this.httpGet("dict/getDictDataListByDictType",{dictType:e});return t}return[]},validateFrom(e){return new Promise(((t,i)=>{e.validate(((e,o)=>{e?t():i()}))}))}}};const P=(0,I.Z)(A,[["render",s],["__scopeId","data-v-716ea24f"]]);var U=P,j=i(5408),z=(i(4415),i(3942),i(814));i(1849);(0,o.ri)(U).use(j.Z,{locale:z.Z}).mount("#app")}},t={};function i(o){var r=t[o];if(void 0!==r)return r.exports;var a=t[o]={exports:{}};return e[o].call(a.exports,a,a.exports,i),a.exports}i.m=e,function(){i.amdO={}}(),function(){var e=[];i.O=function(t,o,r,a){if(!o){var n=1/0;for(u=0;u<e.length;u++){o=e[u][0],r=e[u][1],a=e[u][2];for(var s=!0,d=0;d<o.length;d++)(!1&a||n>=a)&&Object.keys(i.O).every((function(e){return i.O[e](o[d])}))?o.splice(d--,1):(s=!1,a<n&&(n=a));if(s){e.splice(u--,1);var c=r();void 0!==c&&(t=c)}}return t}a=a||0;for(var u=e.length;u>0&&e[u-1][2]>a;u--)e[u]=e[u-1];e[u]=[o,r,a]}}(),function(){i.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return i.d(t,{a:t}),t}}(),function(){i.d=function(e,t){for(var o in t)i.o(t,o)&&!i.o(e,o)&&Object.defineProperty(e,o,{enumerable:!0,get:t[o]})}}(),function(){i.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}(),function(){var e={143:0};i.O.j=function(t){return 0===e[t]};var t=function(t,o){var r,a,n=o[0],s=o[1],d=o[2],c=0;if(n.some((function(t){return 0!==e[t]}))){for(r in s)i.o(s,r)&&(i.m[r]=s[r]);if(d)var u=d(i)}for(t&&t(o);c<n.length;c++)a=n[c],i.o(e,a)&&e[a]&&e[a][0](),e[a]=0;return i.O(u)},o=self["webpackChunkvue3_screen_recording"]=self["webpackChunkvue3_screen_recording"]||[];o.forEach(t.bind(null,0)),o.push=t.bind(null,o.push.bind(o))}();var o=i.O(void 0,[998],(function(){return i(8785)}));o=i.O(o)})();